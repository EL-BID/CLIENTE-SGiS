<!-- crud asignar url de la api URL="url de la api" titulo="un titulo para la pestaña de la pagina" [dato]="variable que contiene el formulario]-->
<formulario #ctrl URL="rutas" titulo="Rutas / Catálogo" [dato]="dato" ></formulario>

<!-- Menu principal "-->
<sistema-menu></sistema-menu>


<div class="contenedor columns " style="height:100%; ">
    <div class="column is-one-quarter is-hidden-mobile menu-izquierda">

        <!-- Menu izquierda del modulo enviroment" -->
        <sistema-menu-aside></sistema-menu-aside>
    </div>
    <div class="column" style="padding:1em;">
        <div style="background: #FFF; border-radius: 1em; ">

            <!-- formulario -->
            <form name="form" novalidate [formGroup]="dato" (ngSubmit)="ctrl.enviar()">
                <section class="hero is-primary">
                    <div class="hero-body">

                        <!-- Opciones  -->
                        <formulario-opciones [ctrl]="ctrl" [id]="ctrl.dato.id"></formulario-opciones>
                    </div>
                </section>

                <section class="section" style="padding: 2rem 2rem !important; overflow:auto;" [style.maxHeight.px]="tamano-175">

                        <div class="control is-grouped">
                                <p class="control is-expanded  has-icon has-icon-right">
                                    <label class="label">Nombre:</label>
                                    <input class="input" autofocus type="text" [ngClass]="{'is-danger': ctrl.dato.get('nombre').hasError('required')}"
                                        placeholder="Nombre" formControlName="nombre">
                                    <span class="icon is-small" *ngIf="ctrl.dato.get('nombre').hasError('required')"><i class="fa fa-warning"></i></span>
                                    <span class="help is-danger" *ngIf="ctrl.dato.get('nombre').hasError('required')">Este campo es requerido.</span>
                                </p>
                         </div>
        
                         <div class="control is-grouped columns">
                             
                                <p class="control is-expanded  has-icon has-icon-right column is-6">
                                    <label class="label">Unidad Médica de Origen:</label>
                                    <input ngui-auto-complete [source]="clues_term" [list-formatter]="autocompleListFormatter" [value-formatter]="valorFormato_origen" id="clues_origen"
                                            path-to-data="" loading-text="Cargando..." no-match-found-text="No hay resultados." (valueChanged)="ctrl.select_item_autocomplete(ctrl.dato.controls.clues_origen, 'clues', $event, true); select_origen_autocomplete($event)"
                                            min-chars="1" class="input" type="text" [ngClass]="{'is-danger': ctrl.dato.get('clues_origen').hasError('required')}"
                                            placeholder="Origen">
        
                                    
                                    <span class="icon is-small" *ngIf="ctrl.dato.get('clues_origen').hasError('required') "><i class="fa fa-warning"></i></span>
                                    <span class="help is-danger" *ngIf="ctrl.dato.get('clues_origen').hasError('required')">Este campo es requerido.</span>
                                </p>
                                
                                <p class="control is-expanded  has-icon has-icon-right column is-6">
                                    <label class="label">Unidad Médica de Destino:</label>
                                    <input ngui-auto-complete [source]="clues_term" [list-formatter]="autocompleListFormatter" [value-formatter]="valorFormato_destino" id="clues_destino"
                                            path-to-data="" loading-text="Cargando..." no-match-found-text="No hay resultados." (valueChanged)="ctrl.select_item_autocomplete(ctrl.dato.controls.clues_destino, 'clues', $event, true); select_destino_autocomplete($event)"
                                            min-chars="1" class="input" type="text" [ngClass]="{'is-danger': ctrl.dato.get('clues_destino').hasError('required')}"
                                            placeholder="Destino">
                                    
                                    <span class="icon is-small" *ngIf="ctrl.dato.get('clues_destino').hasError('required')"><i class="fa fa-warning"></i></span>
                                    <span class="help is-danger" *ngIf="ctrl.dato.get('clues_destino').hasError('required')">Este campo es requerido.</span>
                                </p>
                         </div>
        
                         <div class="control is-grouped columns">
                                <p class="control is-expanded  has-icon has-icon-right column is-6">
                                    <label class="label">Tiempo de traslado:</label>
                                    <input class="input" autofocus type="text" placeholder="Tiempo de Traslado" formControlName = "tiempo_traslado" readonly>
                                </p>
        
                                <p class="control is-expanded  has-icon has-icon-right column is-6">
                                    <label class="label">Distancia de traslado:</label>
                                    <input class="input" autofocus type="text" placeholder="Distancia de Traslado" formControlName = "distancia_traslado" readonly>
                                </p>
                         </div>
        
                        <div class="control is-grouped">
                                <p class="control is-expanded  has-icon has-icon-right">
                                    <label class="label">Descripción de la Ruta:</label>
                                    <textarea class="textarea" autofocus type="text" placeholder="Descripción de la Ruta" formControlName = "observaciones" readonly></textarea>
                                </p>
        
                        </div>
                        
                        <br>
        
                        <p class="control">
                            <button id="drop" class="button is-primary" type="button" (click)="dibujarMarker(ctrl.clues)">Cargar Clues</button>
                        </p>
        
                        <br>
        
                        <div style="height: 500px; border-radius: 15px" id="map"></div>

                </section>
            </form>
        </div>
    </div>
</div>